# 图片预览组件功能修改说明

## 修改概述

本次修改为图片预览组件添加了**仅显示重复图片**的功能，用户现在可以选择只查看重复漫画组中的重复图片，而不是显示所有图片。

## 新增功能

### 1. 显示模式切换
- 添加了"仅显示重复图片"复选框
- 用户可以在两种模式间切换：
  - **全部图片模式**：显示选中漫画的所有图片（原有功能）
  - **重复图片模式**：仅显示该漫画中与其他漫画重复的图片

### 2. 重复图片特殊显示
- 重复图片使用**橙色边框**进行标识
- 显示详细信息包括：
  - 图片文件名
  - 来源漫画名称
  - 图片尺寸
- 图片信息使用橙色粗体字显示

### 3. 智能控件管理
- 在"仅显示重复图片"模式下，图片数量控件自动禁用
- 在"全部图片"模式下，图片数量控件正常工作

### 4. 增强的信息显示
- 标题栏显示当前显示模式
- 漫画信息显示总图片数和重复图片数
- 状态栏显示加载进度和结果

## 技术实现

### 新增类
- `DuplicateImageLoadThread`：专门用于加载重复图片的线程类
- 支持根据图片哈希值查找和加载对应的图片文件

### 修改的方法
- `load_preview_images()`：根据显示模式选择不同的加载策略
- `update_info_display()`：显示重复图片统计信息
- `add_duplicate_image_to_display()`：专门用于显示重复图片的方法

### 新增事件处理
- `on_display_mode_changed()`：处理显示模式切换
- `on_duplicate_image_loaded()`：处理重复图片加载完成
- `on_duplicate_image_load_error()`：处理重复图片加载错误

## 使用方法

1. 在重复漫画列表中选择一个漫画
2. 在图片预览区域勾选"仅显示重复图片"复选框
3. 预览区域将只显示该漫画中与其他漫画重复的图片
4. 重复图片会以橙色边框突出显示
5. 取消勾选复选框可返回显示全部图片模式

## 优势

1. **提高效率**：用户可以快速定位重复内容，无需浏览所有图片
2. **直观显示**：重复图片通过特殊样式清晰标识
3. **保持兼容**：原有的全部图片显示功能完全保留
4. **性能优化**：只加载需要显示的重复图片，减少资源消耗

## 测试

运行 `test_preview_widget.py` 可以测试新功能：

```bash
python test_preview_widget.py
```

该测试脚本会创建模拟的重复漫画数据，展示新功能的使用效果。